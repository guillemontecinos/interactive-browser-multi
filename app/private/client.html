<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Client</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.1.9/lib/p5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.js"></script>
</head>
<body>
    <div class="username-input">
        <input class="username-value" type="text" id="username-value">
        <button class="username-submit" id="username-submit">Submit</button>
    </div>
    <script>
        // Interactive Browser Multiuser - Client
        // by Guillermo Montecinos

        // Source: https://socket.io/docs/#Using-with-Express
        // TODO: update this address with the current IP
        
        let socket, name = '', input, button

        function setup(){
            input = document.getElementById('username-value')
            button = document.getElementById('username-submit')
            button.addEventListener('click', buttonSubmit)
        }

        function buttonSubmit(){
            if(input.value == '') return
            name = input.value
            socket = io.connect('http://localhost')
            socket.emit('nickname', name)

            input.remove()
            button.remove()
            
            createCanvas(800, 500)
            strokeWeight(5)
            rect(0, 0, width, height)
        }

        function mouseMoved(){
            let x = constrain(map(mouseX, 0, width, 0, 1), 0, 1)
            let y = constrain(map(mouseY, 0, height, 0, 1), 0, 1)
            console.log('x: ' + x + ', y: ' + y)
            socket.emit('mouse moved', {x: x, y: y})
        }
    </script>
</body>
</html>